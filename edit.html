<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <style>
      body{
        padding-left: 50px;
        padding-right: 50px;
      }
      textarea{
        font-family: "Courier New", monospace;
        font size: 14px;
      }
      .header{
        text-align: center;
        padding-top: 50px;
        padding-bottom: 50px;
        font-family: "Courier", monospace;
        font-size: 48px;
        font-weight: bold;
      }
      .subheader{
        font-family: "Courier", monospace;
        font-weight: bold;
      }
    </style>
  </head>

  <body>
    <h1 class="header"> Editing {{.Title}}.txt </h1>
    <div class="subheader row">
      <div class="col"><h2><b>Code</b></h2></div>
      <div class="col"><h2><b>Notes</b></h2></div>
    </div>
    <div class="row">
      <div id="lineCount" cols="3">1</div>
      <textarea class="col" name="body" id=writer rows="20" autofocus>{{printf "%s" .Body}}</textarea>
      <textarea class="col" rows="20" placeholder="Place for notes..."></textarea>
    </div>

    <script>
      function update() {
        var body = document.getElementById('writer').value
        var path = "/save/" + {{.Title}}
        updateLineCount()
        postBody(path, body);
      }

      function postBody(path, body) {
        var xhr = new XMLHttpRequest()

        xhr.open("POST", path, true)
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8")
        xhr.send(body)
      }

      function updateLineCount(){
        var lines = document.getElementById('writer').value
        var count = lines.split(/\r\n|\r|\n/).length;
        setLineCount(count)
      }

      function setLineCount(count) {
        var display = ""
        var lineNum = 1
        while(lineNum <= count) {
          display += (lineNum)+"<br>"
          lineNum++
        }
        document.getElementById("lineCount").innerHTML = display
      }

      //Startup commands
      console.log("Hello in edit.html")
      setInterval(update, 100)
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
  </body>
</html>
